<!DOCTYPE html>
<html>
  <head>
    <title>Gifted-Dave-MD - Pair Code Session</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
        padding: 50px;
      }

      input, button {
        padding: 10px;
        margin: 10px;
        width: 80%;
        max-width: 300px;
        font-size: 16px;
      }

      .status {
        margin-top: 20px;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <h1>üîó Generate Pair Code</h1>
    <p>Enter your WhatsApp number to receive a pairing code:</p>
    <input type="text" id="number" placeholder="e.g. +254712345678" />
    <br />
    <button onclick="generate()">Generate Pair Code</button>

    <div class="status" id="status"></div>

    <script>
      async function generate() {
        const number = document.getElementById('number').value.trim();
        const status = document.getElementById('status');
        
        if (!number.startsWith('+')) {
          status.textContent = "‚ùå Please enter a valid WhatsApp number (with +254...)";
          return;
        }

        status.textContent = "‚è≥ Sending request...";
        
        try {
          const res = await fetch("https://gifted-session-backend.vercel.app/pair", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ number }),
          });

          const data = await res.json();

          if (data.pairingCode) {
            status.innerHTML = `‚úÖ Pair code: <b>${data.pairingCode}</b><br>Check your WhatsApp to complete pairing.`;
          } else {
            status.textContent = "‚ùå Failed to generate pair code. Please try again.";
          }
        } catch (err) {
          status.textContent = "‚ùå Error contacting backend.";
        }
      }
    </script>
  </body>
</html>
